<div class="container-fluid mp--wrapper app--managedetails--wrapper">
    <div class="row">
        <div class="col-12 d-flex align-items-center mb-4 mt-4">
            <button mat-stroked-button color="primary" class="me-3 back--btn" [routerLink]="['/patient/dashboard']">
                <mat-icon class="material-symbols-outlined flex-shrink-0 m-0"> keyboard_backspace </mat-icon>
            </button>
            <h3 class="mb-0 clr--1F2F3E fw-600">Manage Profile</h3>
        </div>
    </div>
    <div class="card">
        <mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start" [(selectedIndex)]="selectedTab">
            <mat-tab label="Personal Information">
                <div class="card-body mt-4">                   
                    <form class="row" [formGroup]="firstFormGroup" (ngSubmit)="goToNext(0,firstFormGroup.value)">
                        <div class="col-12 d-flex align-items-center mb-4">
                          <div class="profile--left d-flex flex-column position-relative flex-shrink-0">
                              <div class="head--sec w-100" *ngIf="editOptions">
                                  <mat-list>
                                      <mat-list-item>Change Photo </mat-list-item>
                                      <mat-list-item>Remove Photo </mat-list-item> 
                                  </mat-list>
                              </div> 
                              <div class="profile--round position-relative">
                                  <img src="assets/images/ark/user.png"  alt="" class="img-fluid user--img" />
                                  <button mat-raised-button color="primary" class="edit--btn" (click)="editProfilePic()"> 
                                      <mat-icon class="material-symbols-outlined flex-shrink-0 m-0 "> edit </mat-icon> 
                                  </button>
                              </div> 
                          </div>
                          <button mat-stroked-button color="primary" (click)="changePassword()">Change Password</button> 
                        </div>
                        <div class="col-12 col-sm-6 col-lg-4">
                            <div class="form-group">
                                <label class="col-form-label fw-600">First Name <span class="clr--DF0404 ms-1"> * </span></label>
                                <input class="form-control text-capitalize" type="text" required="" placeholder="Enter First Name" (blur)="checkSpace(firstFormGroup.controls['firstName'], $event)" formControlName="firstName" maxlength="35"/>
                                <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['firstName'].touched && (firstFormGroup.controls['firstName'].hasError('required') || firstFormGroup.controls['firstName'].invalid)">
                                  {{ validationMessages.required('First Name') }}
                                </div>                            
                            </div>
                        </div>
                        <div class="col-12 col-sm-6 col-lg-4">
                            <div class="form-group">
                                <label class="col-form-label fw-600">Middle Name </label>
                                <input class="form-control text-capitalize" type="text" placeholder="Enter Middle Name" (blur)="checkSpace(firstFormGroup.controls['middleName'], $event)" formControlName="middleName" maxlength="35" />
                                <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['middleName'].touched && (firstFormGroup.controls['middleName'].hasError('required') || firstFormGroup.controls['middleName'].invalid)">
                                  {{ validationMessages.required('Middle Name') }}
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-sm-6 col-lg-4">
                            <div class="form-group">
                                <label class="col-form-label fw-600">Last Name  <span class="clr--DF0404 ms-1"> * </span></label>
                                <input class="form-control text-capitalize" type="text" placeholder="Enter Last Name" (blur)="checkSpace(firstFormGroup.controls['lastName'], $event)" formControlName="lastName" maxlength="35"/>
                                <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['lastName'].touched && (firstFormGroup.controls['lastName'].hasError('required') || firstFormGroup.controls['lastName'].invalid)">
                                  {{ validationMessages.required('Last Name') }}
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-sm-6 col-lg-4">
                          <div class="form-group">
                            <label class="col-form-label fw-600">Date of Birth <span class="clr--DF0404 ms-1"> * </span></label>
                            <div class="input-group">
                              <input class="form-control text-lowercase" placeholder="mm-dd-yyyy" name="dp" [(ngModel)]="selectedDate"
                              ngbDatepicker #d="ngbDatepicker" (ngModelChange)="onDateChange($event)" formControlName="dob" [value]="selected_date" [minDate]="getMinDate()"  [maxDate]="maxEndDate" />
                              <button class="btn btn-outline-primary py-0 px-3 calender--btn" (click)="d.toggle()"
                              type="button">
                              <i class="fa fa-calendar-o clr--fff" aria-hidden="true"></i>
                              </button>
                            </div>
                            <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['dob'].hasError('required') && firstFormGroup.controls['dob'].touched">
                              {{ validationMessages.required('Date of Birth') }}</div>
                            </div>
                        </div>
                        <div class="col-12 col-sm-6 col-lg-4">
                          <div class="form-group">
                            <label class="col-form-label fw-600">Marital Status <span class="clr--DF0404 ms-1"> * </span></label>
                            <select class="form-select form-control" id="maritalStatus" aria-label="Default select example" formControlName="maritalStatus">
                              <option selected>Select</option>
                              <option value="Married">Married</option>
                              <option value="Unmarried">Unmarried</option>                                 
                            </select>                               
                            <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['maritalStatus'].touched && firstFormGroup.controls['maritalStatus'].hasError('required')">
                              {{ validationMessages.requiredDropdown('Marital Status') }}
                            </div>                         
                          </div>
                        </div>
                        <div class="col-12 col-sm-6 col-lg-4">
                          <div class="form-group">
                              <label class="col-form-label fw-600">Gender <span class="clr--DF0404 ms-1"> * </span></label>  
                              <mat-radio-group aria-label="Select an option" formControlName="gender" >
                                <mat-radio-button value="Male" class="me-3">Male</mat-radio-button>
                                <mat-radio-button value="Female">Female</mat-radio-button>
                                <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['gender'].hasError('required') && firstFormGroup.controls['gender'].touched">
                                  {{ validationMessages.radioButton }}</div>
                              </mat-radio-group>
                            </div>
                        </div>
                        <div class="col-12 col-sm-6 col-lg-4">
                          <div class="form-group">
                            <label class="col-form-label fw-600">Email  <span class="clr--DF0404 ms-1"> * </span></label>
                            <input class="form-control text-lowercase" type="email" placeholder="Enter Email" formControlName="email" readonly/>
                            <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['email'].touched && (firstFormGroup.controls['email'].hasError('required') || firstFormGroup.controls['email'].invalid)">
                              {{ validationMessages.required('Email') }}
                            </div>
                            <div class="text text-danger mt-1" *ngIf="emailError">
                                {{invalidEmailErrorMessage}}
                          </div>
                          </div>
                        </div>
                        <div class="col-12 col-sm-6 col-lg-4">
                          <div class="form-group">
                            <label class="col-form-label fw-600">Phone Number<span class="clr--DF0404 ms-1"> * </span></label>
                            <input class="form-control" type="text" placeholder="Enter Phone Number" (input)="onPhoneInputChange($event)" [value]="convertPhoneNumber" maxlength="14" formControlName="phoneNumber"/>                            
                            <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['phoneNumber'].touched && firstFormGroup.controls['phoneNumber'].hasError('required')">
                              {{ validationMessages.required('a valid phone number') }}
                            </div>
                            <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['phoneNumber'].touched && firstFormGroup.controls['phoneNumber'].hasError('pattern')">
                                {{ validationMessages.invalidPhoneNumber }}
                            </div>
                          </div>
                        </div>
                        <div class="col-12 col-sm-6 col-lg-4">
                          <div class="form-group">
                            <label class="col-form-label fw-600">Cell Phone Number  </label>
                            <input class="form-control" type="text" placeholder="Enter Cell Phone Number" (input)="onCellPhoneInputChange($event)" [value]="convertCellPhoneNumber" maxlength="14" formControlName="cellPhoneNumber"/>                            
                            <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['cellPhoneNumber'].touched && firstFormGroup.controls['cellPhoneNumber'].hasError('required')">
                              {{ validationMessages.required('a valid cell phone number') }}
                            </div>
                            <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['cellPhoneNumber'].touched && firstFormGroup.controls['cellPhoneNumber'].hasError('pattern')">
                                {{ validationMessages.invalidPhoneNumber }}
                            </div>
                          </div>
                        </div>
                        <div class="col-12 col-sm-6 col-lg-4">
                          <div class="form-group">
                            <label class="col-form-label fw-600">Work Extension Number</label>
                            <input class="form-control" type="text" placeholder="Enter Work Extension Number" (input)="onWorkExtensionInputChange($event)" [value]="convertWorkExtensionNumber" maxlength="14" formControlName="workExtensionNumber"/>                            
                            <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['workExtensionNumber'].touched && firstFormGroup.controls['workExtensionNumber'].hasError('required')">
                              {{ validationMessages.required('a valid work extension number') }}
                            </div>
                            <div class="text text-danger mt-1" *ngIf="firstFormGroup.controls['workExtensionNumber'].touched && firstFormGroup.controls['workExtensionNumber'].hasError('pattern')">
                                {{ validationMessages.invalidPhoneNumber }}
                            </div>

                          </div>
                        </div>
                        <div class="col-12 d-flex justify-content-end action--footer">
                          <button mat-raised-button color="primary" class="btn btn-primary" type="submit">Save & Continue</button>
                        </div>
                    </form> 
                </div>
            </mat-tab>
            <mat-tab label="Additional Information">
                <div class="card-body mt-4">
                   <form class="row" [formGroup]="secondFormGroup" (ngSubmit)="goToNext(1,secondFormGroup.value)">
                        <div class="col-12">
                            <div class="form-group">
                                <label class="col-form-label fw-600">Street Name<span class="clr--DF0404 ms-1"> * </span></label>
                                <input class="form-control" type="text" placeholder="Enter Street Name" formControlName="address1" />
                                <div class="text text-danger mt-1" *ngIf="secondFormGroup.controls['address1'].touched && (secondFormGroup.controls['address1'].hasError('required') || secondFormGroup.controls['address1'].invalid)">
                                  {{ validationMessages.required('Street Name') }}
                                </div>
                            </div>
                        </div>  
                        <div class="col-12 col-sm-6">
                            <div class="form-group">
                                <label class="col-form-label fw-600">Apartment # <span class="clr--DF0404 ms-1"> * </span></label>                               
                                <input class="form-control" type="text" placeholder="Apartment #" formControlName="address2" />
                                <div class="text text-danger mt-1" *ngIf="secondFormGroup.controls['address2'].touched && (secondFormGroup.controls['address2'].hasError('required') || secondFormGroup.controls['address2'].invalid)">
                                  {{ validationMessages.required('Apartment') }}
                                </div>
                            </div>
                        </div>
                          <div class="col-12 col-sm-6">
                            <div class="form-group">
                              <label class="col-form-label fw-600">State  <span class="clr--DF0404 ms-1"> * </span></label>
                              <select class="form-select form-control" id="state" aria-label="Default select example" formControlName="state"  (ngModelChange)="onStateChange($event)">
                                <option selected value="">Select State</option>
                                <option *ngFor="let item of states" value="{{item.state_code}}" [selected]="">{{item.state}}</option>
                              </select>                               
                              <div class="text text-danger mt-1" *ngIf="secondFormGroup.controls['state'].touched && secondFormGroup.controls['state'].hasError('required')">
                                {{ validationMessages.requiredDropdown('State') }}
                              </div>
                            </div>
                          </div>
                          <div class="col-12 col-sm-6">
                            <div class="form-group">
                              <label class="col-form-label fw-600">City  <span class="clr--DF0404 ms-1"> * </span></label>
                              <select class="form-select form-control" id="city" aria-label="Default select example" [(ngModel)]="selectedCity" formControlName="city">
                                <option selected value="">Select City</option>
                                <option *ngFor="let item of cities" value="{{item.city}}" >{{item.city}}</option>
                                <!-- [selected]="item.city==selectedCity" -->
                              </select>
                              
                              <div class="text text-danger mt-1" *ngIf="secondFormGroup.controls['city'].touched && secondFormGroup.controls['city'].hasError('required')">
                                {{ validationMessages.requiredDropdown('City') }}
                              </div>
                            </div>
                          </div>
                          <div class="col-12 col-sm-6">
                            <div class="form-group">
                                <label class="col-form-label fw-600">Postal Code  <span class="clr--DF0404 ms-1"> * </span></label>
                                <input class="form-control" type="text" placeholder="Enter Postal Code" formControlName="zipcode" maxlength="6"/>
                                <div class="text text-danger mt-1" *ngIf="secondFormGroup.controls['zipcode'].touched && (secondFormGroup.controls['zipcode'].hasError('required') || secondFormGroup.controls['zipcode'].invalid)">
                                  {{ validationMessages.required('Zipcode') }}
                                </div>
                            </div>
                        </div>
                          <div class="col-12 d-flex justify-content-between action--footer">
                            <a mat-stroked-button color="primary" (click)="backtoTab1()">Previous</a>
                            <button mat-raised-button color="primary"  (click)="gotostep3()">Save & Continue</button>
                          </div>
                    </form>
                    
                </div>
            </mat-tab>
            <mat-tab label="Verification">
                <div class="card-body mt-4">
                  <form class="row" [formGroup]="thirdFormGroup" (ngSubmit)="goToNext(2,thirdFormGroup.value)">
                          <div class="col-12">
                            <div class="form-group">
                              <label class="col-form-label fw-600">Type of ID Proof {{selectedDocumentsType}}</label>
                              <select class="form-select form-control" id="documents_type" aria-label="Default select example" [(ngModel)]="selectedDocumentsType" formControlName="documents_type">
                                <option [selected]="!selectedDocumentsType" value="">Select Type of ID Proof</option>
                                <option *ngFor="let item of documents_type_list" value="{{item}}" [selected]="selectedDocumentsType==item">{{item}}</option>                              
                              </select>                            
                              <div class="text text-danger mt-1" *ngIf="thirdFormGroup.controls['documents_type'].touched && thirdFormGroup.controls['documents_type'].hasError('required')">
                                {{ validationMessages.requiredDropdown('ID Proof') }}
                              </div>
                              <div class="text text-danger mt-1" *ngIf="thirdFormGroup.errors?.['documents_type_empty']">
                                {{ validationMessages.requiredProofDocument }}
                              </div>
                            </div>
                          </div>
                          
                         <div class="col-12">
                            <div class="upload--files d-flex align-items-center justify-content-center flex-column w-100 text-center">
                              <div class="upload--box" ng2FileDrop [ngClass]="{'nv-file-over': hasBaseDropZoneOver}" [uploader]="uploader" (fileOver)="fileOverBase($event)">
                                <input class="input--file" type="file" name="documents" ng2FileSelect [uploader]="uploader"  (change)="fileOverBase($event)" />
                                  <mat-icon > upload_file </mat-icon>
                                  <h6 class="font-18 fw-500">Upload Your Driver License or drag & drop it here</h6>
                                  <p class="mb-0 font-14 fw-500">JPEG, JPG, PNG, PDF formats, up to 5MB</p>
                              </div>
                            </div>
                          </div>

                          <mat-form-field class="full-width" *ngIf="documents_temps">
                            <input matInput name="documents_temp" formControlName="documents_temp" />      
                          </mat-form-field>
                          <div class="text text-danger mt-1 form-error-msg" *ngIf="thirdFormGroup.controls['documents_temp'].hasError('required') && thirdFormGroup.controls['documents_temp'].touched"> Please drag your document. </div>
                          <div class="text text-danger mt-1 form-error-msg" *ngIf="thirdFormGroup.errors?.['documents_temp_empty']"> {{ validationMessages.requiredDocument }} </div>
                          <div class="text text-danger mt-1 form-error-msg" *ngIf="fileErrors"> {{ fileErrors }} </div>

                          <div class="col-12 d-flex align-items-center mb-3">
                            <div class="row align-items-center w-100">
                              <div class="col-11">
                                <div class="d-flex align-items-center w-100">
                                  <div class="doc--pic d-flex align-items-center justify-content-center" *ngIf="!documentsMissing">
                                    <span *ngIf="fileType && fileType === 'image'">
                                      <img [src]="documentsLink" alt="{{documentsName}}"  class="img-fluid" >
                                    </span>
                                    <span *ngIf="fileType && fileType === 'doc'">
                                      <mat-icon> file_copy </mat-icon>
                                    </span>
                                    <span *ngIf="fileType && (fileType === 'pdf')">
                                      <mat-icon> picture_as_pdf </mat-icon>
                                    </span>
                                    <span *ngIf="fileType && fileType === 'unknown'">
                                      <mat-icon> file_copy </mat-icon>
                                    </span>
                                   </div>
                                  <div class="d-flex flex-column w-100 doc--desc" *ngIf="!documentsMissing">
                                      <h5 class="font-16">{{documentsName}}</h5>
                                      <p class="m-0 font-14" *ngIf="document_size">{{document_size}}</p>
                                  </div> 
                                </div>
                              </div>
                              <div class="col-1 d-flex justify-content-end pe-0" *ngIf="!documentsMissing">
                                <div mat-button class="p-0 flex-shrink-0 min-width-unset" (click)="documentDelete();">
                                  <span class="material-icons cancel--btn"> cancel </span>
                                </div>
                              </div>
                            </div>
                           
                          </div>
                          <div class="col-12 d-flex justify-content-between action--footer">
                            <a mat-stroked-button color="primary" (click)="backtoTab2()">Previous</a>
                            <button mat-raised-button color="primary" type="submit">Save </button>
                          </div>
                    </form>
                </div>
            </mat-tab>
        </mat-tab-group>

    </div>
</div>